const html=document.documentElement;let darkTheme=localStorage.getItem("darkTheme");function switchTheme(){html.classList.toggle("dark"),html.classList.add("theme-in-transition"),setTimeout(function(){html.classList.remove("theme-in-transition")},500),"true"==darkTheme?localStorage.setItem("darkTheme","false"):localStorage.setItem("darkTheme","true")}"true"==darkTheme&&html.classList.add("dark");let selectedMarks=[];const marksList=document.querySelector(".marks__list");function changeType(e){"city"==e||"other"==e?(document.querySelector("#name").style.display="block",document.querySelector(".residents").style.display="block","other"==e?(document.querySelector(".residents").style.display="none",document.querySelector("#mayor legend").innerText="Владелец",document.querySelector("#name legend").innerText="Название заведения",document.querySelector(".marks").classList.remove("optional")):(document.querySelector("#name legend").innerText="Название города",document.querySelector("#mayor legend").innerText="Мэр",document.querySelector(".marks").classList.add("optional"))):"end"!=e&&"base"!=e||(document.querySelector("#name").style.display="none",document.querySelector(".residents").style.display="none",document.querySelector("#mayor legend").innerText="Владелец","end"==e?document.querySelector("#mayor").classList.add("optional"):document.querySelector("#mayor").classList.remove("optional")),document.querySelector(".marks").style.display="end"!=e?"block":"none"}function showError(e,r){return r?(window.scrollTo({top:e.scrollTop,behavior:"smooth"}),e.classList.add("error")):e.classList.remove("error"),r}function marksUpdate(e){const r=document.createElement("span");if(selectedMarks.includes('"'+e.value+'"')){const r=selectedMarks.findIndex(r=>e.value==r);-1!==r&&selectedMarks.splice(r,1),document.querySelector("#mark--"+e.value).remove()}else selectedMarks.push('"'+e.value+'"'),r.innerText=document.querySelector(`[value="${e.value}"]`).innerText,r.id="mark--"+e.value,r.className="marks__item",marksList.appendChild(r);e.value=" "}function submit(){let e=!1;const r={type:getInputByName("type"),branch:getInputByName("branch"),subbranch:document.querySelector("#subbranch"),name:document.querySelector("#name input"),mayor:document.querySelector("#mayor input"),netherX:document.querySelector("#netherX"),netherY:document.querySelector("#netherY"),netherZ:document.querySelector("#netherZ"),overworldX:document.querySelector("#overworldX"),overworldY:document.querySelector("#overworldY"),overworldZ:document.querySelector("#overworldZ"),description:document.querySelector("#description"),residents:document.querySelector("#residents"),pictures:document.querySelector("#pictures")};for(let t in r){const n=r[t];n==r.description||n==r.residents||n==r.overworldX||n==r.overworldY||n==r.overworldZ||n==r.subbranch||n==r.marks||"end"==r.type.value&&(n==r.mayor||n==r.name)||"base"==r.type.value&&n==r.name||showError(n,null==n.value||""==n.value)&&(e=!0)}if(!e){let e="{\n";if("city"!=r.type.value&&(e+=`    "type": "${r.type.value}",\n`),"end"!=r.type.value&&"base"!=r.type.value&&""!=r.name.value&&(e+=`    "name": "${r.name.value.replace(/"([^"]*)"/g,"«$1»").replace(/(^\s*)|(\s*)$/g,"")}",\n`),""!=r.mayor.value&&(e+=`    "mayor": "${r.mayor.value.replace(/"([^"]*)"/g,"«$1»").replace(/(^\s*)|(\s*)$/g,"")}",\n`),e+=`    "branch": "${r.branch.value}",\n`,r.subbranch.checked){let t="";"red"==r.branch.value||"yellow"==r.branch.value?(r.netherX.value>0&&(t="blue"),r.netherX.value<0&&(t="green")):(r.netherZ.value>0&&(t="red"),r.netherZ.value<0&&(t="yellow")),e+=`    "subbranch": "${t}",\n`}if(e+='    "nether": {\n',e+=`        "x": ${r.netherX.value},\n`,"65"!=r.netherY.value&&(e+=`        "y": ${r.netherY.value},\n`),e+=`        "z": ${r.netherZ.value}\n`,e+="    },\n",""!=r.overworldX.value&&""!=r.overworldY.value&&""!=r.overworldZ.value&&(e+='    "overworld": {\n',e+=`        "x": ${r.overworldX.value},\n`,e+=`        "y": ${r.overworldY.value},\n`,e+=`        "z": ${r.overworldZ.value}\n`,e+="    },\n"),""!=r.description.value&&(e+=`    "description": "${r.description.value.replace(/\n/g,"<br>").replace(/"([^"]*)"/g,"«$1»").replace(/(^\s*)|(\s*)$/g,"")}",\n`),""!=r.residents.value){e+='    "residents": [',res=r.residents.value.split(",");for(var t=0;t<res.length;t++)""!=res[t]&&(e+=`"${res[t].replace(/"([^"]*)"/g,"«$1»").replace(/(^\s*)|(\s*)$/g,"")}"`,t<res.length-1&&(e+=", "));e+="],\n"}selectedMarks.length&&(e+='    "marks": ['+selectedMarks,e+="],\n"),r.pictures.checked&&(e+='    "pictures": "true",\n'),copy(e=(e+="}").replace(",\n}","\n}"));const n=document.getElementById("btn"),o=n.innerText;n.innerText="Скопировано в буфер обмена",setTimeout(function(){n.innerText=o},5e3)}}function getInputByName(e){const r=document.querySelectorAll('[name="'+e+'"]');for(var t=r.length-1;t>=0;t--)if(r[t].checked)return r[t];return document.querySelector("#"+e)}function copy(e){const r=document.createElement("textarea");r.className="vissualy-hidden",r.value=e,document.body.appendChild(r),r.select(),r.setSelectionRange(0,99999),document.execCommand("copy"),r.remove()}function loadStyle(e){let t=document.createElement("link");t.rel="stylesheet",t.href="../style/"+e+".css",t.classList.add("style--"+e),document.head.appendChild(t)}window.onload=function(){loadStyle("font")};